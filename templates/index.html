<!DOCTYPE html>
<html lang="en">
 
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" 
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" 
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous">
    </script>

    <script lang="javascript">
        var SERVER = "http://localhost:5000/api/1.0/"
        var WPUUID = "a910b90e-da33-11ec-8236-704d7b84fd9f"
        var tinyEditor = null;
        $(document).ready(function(){

            // jQuery methods go here...
            $("#theButton").on("click", () => {
                console.info("INFO: pressed the button");
                $.get(SERVER+"getwp", data={ "uuid":WPUUID }, (data) => {
                    text = data["text"];
                    if (tinyEditor!=null) {
                        // tinymce.get('#texteditor').setContent(data);
                        tinymce.activeEditor.setContent(text);
                    } else {
                        alert("We reseived a text, but cnnot edit it^ "+text);
                    }
                });
            });

            $("#saveButton").on("click", () => {
                console.info("Save pressed");
                $.ajax(SERVER+"savewp", data={
                    data : JSON.stringify({"uuid":WPUUID, "text":tinymce.activeEditor.getContent()}),
                    contentType : 'application/json',
                    type : 'POST'}, (data) => {
                    var err = data["error"]
                    if (err!=0) {
                        $("#alertBox").text("Could'nt save correctly:"+err);
                    } else {
                        $("#alertBox").text("Sucessfully aved!");
                    }
                });
            });
            $("#saveGraphButton").on("click", () => {
                $.post(SERVER+"saveGraph", (data) => {
                    $("alertBox").text("Saved Successfully!");
                    console.info("Saved the gaph successfully!");
                })
            });

        })
    </script>
</head>
 
<body>
     <section>
        <form method="post">
            <textarea id="texteditor"> Here will be edited something! </textarea>
          </form>
    </section>
    <script>
        tinyEditor = tinymce.init({
          selector: '#texteditor'
        });
    </script>
    <button id="theButton" type="button" class="btn btn-primary">Load</button>
    <button id="saveButton" type="button" class="btn btn-primary">Save</button>
    <button id="saveGraphButton" type="button" class="btn btn-info">Save Graph</button>
    <div class="alert alert-primary" role="alert" id="alertBox">
        This is a primary alertâ€”check it out!
      </div>

</body>
 
</html>